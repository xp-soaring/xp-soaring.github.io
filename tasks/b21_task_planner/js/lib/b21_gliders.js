var B21_WEATHER_DATA = {
    "SSC3 001 Clear Sky N 10kt": { "hash": ["4322775","2566295"]},
    "SSC3 002 Clear Sky N 15kt": { "hash": ["1710183","4983577"]},
    "SSC3 003 Clear Sky NE 10kt": { "hash": ["3292765","5709675"]},
    "SSC3 004 Clear Sky NE 15kt": { "hash": ["8501331","4478131"]},
    "SSC3 005 Clear Sky E 10kt": { "hash": ["6050290","4094504"]},
    "SSC3 006 Clear Sky E 15kt": { "hash": ["7961238","1854518"]},
    "SSC3 007 Clear Sky SE 10kt": { "hash": ["6506468","2256214"]},
    "SSC3 008 Clear Sky SE 15kt": { "hash": ["1579303","4031019"]},
    "SSC3 009 Clear Sky S 10kt": { "hash": ["5695062","1074290"]},
    "SSC3 010 Clear Sky S 15kt": { "hash": ["8792069","7909180"]},
    "SSC3 011 Clear Sky SW 10kt": { "hash": ["1292625","2274906"]},
    "SSC3 012 Clear Sky SW 15kt": { "hash": ["3950159","1748161"]},
    "SSC3 013 Clear Sky W 10kt": { "hash": ["7926456","6361775"]},
    "SSC3 014 Clear Sky W 15kt": { "hash": ["8569390","3343004"]},
    "SSC3 015 Clear Sky NW 10kt": { "hash": ["5608784","8730508"]},
    "SSC3 016 Clear Sky NW 15kt": { "hash": ["7062631","3531229"]},
    "SSC3 017 Few Clouds 6k N 10kt": { "hash": ["7408349","3610209"]},
    "SSC3 018 Few Clouds 6k N 15kt": { "hash": ["1249903","3553952"]},
    "SSC3 019 Few Clouds 6k NE 10kt": { "hash": ["5176924","4646807"]},
    "SSC3 020 Few Clouds 6k NE 15kt": { "hash": ["9990722","9554793"]},
    "SSC3 021 Few Clouds 6k E 10kt": { "hash": ["7584906","4138185"]},
    "SSC3 022 Few Clouds 6k E 15kt": { "hash": ["8795229","7881178"]},
    "SSC3 023 Few Clouds 6k SE 10kt": { "hash": ["4859190","2449843"]},
    "SSC3 024 Few Clouds 6k SE 15kt": { "hash": ["8144049","1918282"]},
    "SSC3 025 Few Clouds 6k S 10kt": { "hash": ["5428564","5745656"]},
    "SSC3 026 Few Clouds 6k S 15kt": { "hash": ["8692665","4862650"]},
    "SSC3 027 Few Clouds 6k SW 10kt": { "hash": ["4671974","4836610"]},
    "SSC3 028 Few Clouds 6k SW 15kt": { "hash": ["4503499","1866725"]},
    "SSC3 029 Few Clouds 6k W 10kt": { "hash": ["4599343","9985440"]},
    "SSC3 030 Few Clouds 6k W 15kt": { "hash": ["2779891","4005063"]},
    "SSC3 031 Few Clouds 6k NW 10kt": { "hash": ["1542857","7472994"]},
    "SSC3 032 Few Clouds 6k NW 15kt": { "hash": ["4851562","8856622"]},
    "SSC3 033 Partly Cloudy 6k N 10kt": { "hash": ["3891887","7007509"]},
    "SSC3 034 Partly Cloudy 6k N 15kt": { "hash": ["6132422","3868051"]},
    "SSC3 035 Partly Cloudy 6k NE 10kt": { "hash": ["8312403","0363262"]},
    "SSC3 036 Partly Cloudy 6k NE 15kt": { "hash": ["8943834","6455359"]},
    "SSC3 037 Partly Cloudy 6k E 10kt": { "hash": ["0135694","5233894"]},
    "SSC3 038 Partly Cloudy 6k E 15kt": { "hash": ["3218196","2732007"]},
    "SSC3 039 Partly Cloudy 6k SE 10kt": { "hash": ["1660788","9107991"]},
    "SSC3 040 Partly Cloudy 6k SE 15kt": { "hash": ["5074728","7508848"]},
    "SSC3 041 Partly Cloudy 6k S 10kt": { "hash": ["3693162","8271396"]},
    "SSC3 042 Partly Cloudy 6k S 15kt": { "hash": ["6047317","3817186"]},
    "SSC3 043 Partly Cloudy 6k SW 10kt": { "hash": ["2358431","3963150"]},
    "SSC3 044 Partly Cloudy 6k SW 15kt": { "hash": ["4995674","8284446"]},
    "SSC3 045 Partly Cloudy 6k W 10kt": { "hash": ["8453729","8883180"]},
    "SSC3 046 Partly Cloudy 6k W 15kt": { "hash": ["5841033","0068700"]},
    "SSC3 047 Partly Cloudy 6k NW 10kt": { "hash": ["2235456","7223658"]},
    "SSC3 048 Partly Cloudy 6k NW 15kt": { "hash": ["1422683","5761552"]},
    "SSC3 049 Strong Clouds 10k N 10kt": { "hash": ["0336076","7890793"]},
    "SSC3 050 Strong Clouds 10k N 15kt": { "hash": ["9726763","9649985"]},
    "SSC3 051 Strong Clouds 10k NE 10kt": { "hash": ["4681600","3069456"]},
    "SSC3 052 Strong Clouds 10k NE 15kt": { "hash": ["4058513","8666371"]},
    "SSC3 053 Strong Clouds 10k E 10kt": { "hash": ["5610933","8335274"]},
    "SSC3 054 Strong Clouds 10k E 15kt": { "hash": ["3761853","9337733"]},
    "SSC3 055 Strong Clouds 10k SE 10kt": { "hash": ["7815273","8393271"]},
    "SSC3 056 Strong Clouds 10k SE 15kt": { "hash": ["4679636","0190805"]},
    "SSC3 057 Strong Clouds 10k S 10kt": { "hash": ["0077413","4132109"]},
    "SSC3 058 Strong Clouds 10k S 15kt": { "hash": ["2959619","4411810"]},
    "SSC3 059 Strong Clouds 10k SW 10kt": { "hash": ["2516100","8627153"]},
    "SSC3 060 Strong Clouds 10k SW 15kt": { "hash": ["2349884","9723752"]},
    "SSC3 061 Strong Clouds 10k W 10kt": { "hash": ["1999846","6945291"]},
    "SSC3 062 Strong Clouds 10k W 15kt": { "hash": ["4998941","8767412"]},
    "SSC3 063 Strong Clouds 10k NW 10kt": { "hash": ["1410283","9161326"]},
    "SSC3 064 Strong Clouds 10k NW 15kt": { "hash": ["8407554","2898843"]},
    "SSC3 065 Scattered Clouds 6k N 10kt": { "hash": ["1187976","9870355"]},
    "SSC3 066 Scattered Clouds 6k N 15kt": { "hash": ["5533600","9677069"]},
    "SSC3 067 Scattered Clouds 6k NE 10kt": { "hash": ["6034151","7823255"]},
    "SSC3 068 Scattered Clouds 6k NE 15kt": { "hash": ["0359439","5290229"]},
    "SSC3 069 Scattered Clouds 6k E 10kt": { "hash": ["0176947","6840350"]},
    "SSC3 070 Scattered Clouds 6k E 15kt": { "hash": ["3186671","2417470"]},
    "SSC3 071 Scattered Clouds 6k SE 10kt": { "hash": ["4013407","3937119"]},
    "SSC3 072 Scattered Clouds 6k SE 15kt": { "hash": ["9766547","7226869"]},
    "SSC3 073 Scattered Clouds 6k S 10kt": { "hash": ["1881024","4784843"]},
    "SSC3 074 Scattered Clouds 6k S 15kt": { "hash": ["6840772","5487891"]},
    "SSC3 075 Scattered Clouds 6k SW 10kt": { "hash": ["3136456","2456909"]},
    "SSC3 076 Scattered Clouds 6k SW 15kt": { "hash": ["6248204","4251355"]},
    "SSC3 077 Scattered Clouds 6k W 10kt": { "hash": ["2208606","1310771"]},
    "SSC3 078 Scattered Clouds 6k W 15kt": { "hash": ["0016300","8736196"]},
    "SSC3 079 Scattered Clouds 6k NW 10kt": { "hash": ["0320733","2885323"]},
    "SSC3 080 Scattered Clouds 6k NW 15kt": { "hash": ["1191779","2644240"]},
    "SSC3 081 Broken Clouds 6k N 10kt": { "hash": ["5969315","8770698"]},
    "SSC3 082 Broken Clouds 6k N 15kt": { "hash": ["6388719","7354070"]},
    "SSC3 083 Broken Clouds 6k NE 10kt": { "hash": ["1210865","7927200"]},
    "SSC3 084 Broken Clouds 6k NE 15kt": { "hash": ["7009342","6010353"]},
    "SSC3 085 Broken Clouds 6k E 10kt": { "hash": ["4055926","4857249"]},
    "SSC3 086 Broken Clouds 6k E 15kt": { "hash": ["6059417","1224296"]},
    "SSC3 087 Broken Clouds 6k SE 10kt": { "hash": ["8149574","6959532"]},
    "SSC3 088 Broken Clouds 6k SE 15kt": { "hash": ["8160688","8577785"]},
    "SSC3 089 Broken Clouds 6k S 10kt": { "hash": ["2546882","2423716"]},
    "SSC3 090 Broken Clouds 6k S 15kt": { "hash": ["7009835","9897642"]},
    "SSC3 091 Broken Clouds 6k SW 10kt": { "hash": ["6156373","9698409"]},
    "SSC3 092 Broken Clouds 6k SW 15kt": { "hash": ["6090143","6235051"]},
    "SSC3 093 Broken Clouds 6k W 10kt": { "hash": ["0331947","9680558"]},
    "SSC3 094 Broken Clouds 6k W 15kt": { "hash": ["4216252","8720206"]},
    "SSC3 095 Broken Clouds 6k NW 10kt": { "hash": ["0213828","1325873"]},
    "SSC3 096 Broken Clouds 6k NW 15kt": { "hash": ["4937958","5727278"]},
    "SSC3 097 Overcast 10k N 10kt": { "hash": ["7244638","6156937"]},
    "SSC3 098 Overcast 10k N 15kt": { "hash": ["6214791","7552383"]},
    "SSC3 099 Overcast 10k NE 10kt": { "hash": ["2952800","7451298"]},
    "SSC3 100 Overcast 10k NE 15kt": { "hash": ["4485259","5363944"]},
    "SSC3 101 Overcast 10k E 10kt": { "hash": ["1874934","8230843"]},
    "SSC3 102 Overcast 10k E 15kt": { "hash": ["7672914","7447026"]},
    "SSC3 103 Overcast 10k SE 10kt": { "hash": ["2275575","2138409"]},
    "SSC3 104 Overcast 10k SE 15kt": { "hash": ["7355058","3920753"]},
    "SSC3 105 Overcast 10k S 10kt": { "hash": ["0957772","4045352"]},
    "SSC3 106 Overcast 10k S 15kt": { "hash": ["0683353","5536629"]},
    "SSC3 107 Overcast 10k SW 10kt": { "hash": ["4563205","0260417"]},
    "SSC3 108 Overcast 10k SW 15kt": { "hash": ["1570114","8498422"]},
    "SSC3 109 Overcast 10k W 10kt": { "hash": ["3334400","5073973"]},
    "SSC3 110 Overcast 10k W 15kt": { "hash": ["9054506","3671422"]},
    "SSC3 111 Overcast 10k NW 10kt": { "hash": ["6858043","7106712"]},
    "SSC3 112 Overcast 10k NW 15kt": { "hash": ["4907792","2427997"]},
    "SSC3 113 Shifting Winds E to S (AGL)": { "hash": ["8841324","1520666"]},
    "SSC3 114 Shifting Winds E to S (AMSL)": { "hash": ["3917803","3917803"]},
    "SSC3 115 Shifting Winds N to E (AGL)": { "hash": ["2665667","8327848"]},
    "SSC3 116 Shifting Winds N to E (AMSL)": { "hash": ["1852437","1852437"]},
    "SSC3 117 Shifting Winds S to W (AGL)": { "hash": ["5695983","8144734"]},
    "SSC3 118 Shifting Winds S to W (AMSL)": { "hash": ["1460024","1460024"]},
    "SSC3 119 Shifting Winds W to N (AGL)": { "hash": ["4946953","7006330"]},
    "SSC3 120 Shifting Winds W to N (AMSL)": { "hash": ["9224800","9224800"]},
    "SSC3 121 Weak Thermals 6k": { "hash": ["1596100","1939317"]},
    "SSC3 122 Strong Thermals 6k": { "hash": ["2117852","3902124"]}
};

class B21_WEATHER {

    constructor() {
    }

    static name_to_hash(name) {
        console.log("B21_WEATHER.name_to_hash", name);
        if (B21_WEATHER_DATA[name] != null) {
            console.log("B21_WEATHER.name_to_hash", name, B21_WEATHER_DATA[name].hash[0]);
            return B21_WEATHER_DATA[name].hash[0];
        }
        return null;
    }

    static hash_to_name(hash) {
        console.log("B21_WEATHER.hash_to_name", hash);
        for ( let name in B21_WEATHER_DATA ) {
            for (let i = 0; i  <  B21_WEATHER_DATA[name].hash.length; i++) {
                let current_hash = B21_WEATHER_DATA[name].hash[i];
                if (current_hash == hash) {
                    console.log("B21_WEATHER.hash_to_name", hash, name);
                    return name;
                }
            }
        }
        return null;
    }

}

// B21_GLIDERS is used to provide 'standard' data for MSFS gliders, including normalising the glider_type
// Static class providec methods:
//
// find_glider_type(title_str) - returns glider_type or ""
// lookup_key(glider_type, key) - returns matching property in B21_GLIDERS_DATA

// Note TITLE_STRS should be LOWER CASE
var B21_GLIDERS_DATA = {
        "AS33": {
            "KEY": "AS33",
            "TITLE": "AS-33 (Madolo)",
            "TITLE_STRS": [ "^as33$", "^as-33" ],
            "NB21_ACFG": [ "128D63EA22585AA47C381FC8",
                        "21735116C3548A2C1B61D69B",
                        "0C26C63E4D7FAD13BC406545"
            ],
            "NB21_FMCG": [ "1B0477A5B0103B6FBBB971A6"
            ],
            "MAX_WEIGHT_KG": 600,
            "VNE_TAS_KPH": 282
        },
        "AS33-15": {
            "KEY": "AS33-15",
            "TITLE": "AS-33 15m (GotFriends)",
            "TITLE_STRS": [ "as.33.*15","as33.*15", "as-33.*15" ],
            "NB21_ACFG": [
                'E79771C31BFCB65B35C1B0B6'  // V1 1.0.3 2024
             ],
            "NB21_FMCG": [
                'F0071E3A06F4EFA1454BC978'  // V1 1.0.3 2024
            ],
            "MAX_WEIGHT_KG": 550,
            "VNE_TAS_KPH": 282
        },
        "AS33-18": {
            "KEY": "AS33-18",
            "TITLE": "AS-33 18m (GotFriends)",
            "TITLE_STRS": [ "as.33.*18", "as33.*18", "as-33.*18" ],
            "NB21_ACFG": [
                'AC1C296A90290B150175BD02', // V1 1.0.1
                'BA8BD315D8CA3EC937FF66A4', // V2 ?
                '902F34ACD16BC5ECBB3F628B', // V3 1.0.3 2024
                '1C8F6DDB3CE0135B3FF65110'  // V4 1.0.5 2024
            ],
            "NB21_FMCG": [
                '119F1C2C0B9C9BE3EFCDFC6D', // V1 1.0.1
                'FCA8B719D90BF9BB7B11E97E', // V2 ?
                'B1FB63B485907BFFB56AA7C5', // V3 1.0.3 2024
                'D55E92597425CED1F3BB118D'  // V4 1.0.5 2024
            ],
            "MAX_WEIGHT_KG": 600,
            "VNE_TAS_KPH": 282
        },
        "ASW28": {
            "KEY": "ASW28",
            "TITLE": "ASW28",
            "TITLE_STRS": [ "asw28", "asw-28" ],
            "MAX_WEIGHT_KG": 525,
            "VNE_TAS_KPH": 282
        },
        "JS3-18": {
            "KEY": "JS3-18",
            "TITLE": "JS3-18 (Madolo)",
            "TITLE_STRS": [ "js3-18", "js 3 18m" ],
            "NB21_ACFG": [ "753B807E002326612ACFA3A3", // V1 MSFS2020
                        "A51EB12DFB0552972D2A0A9E" // V2 MSFS2020+2024 v2.3.1
            ],
            "NB21_FMCG": [ "5395E12E6384EABE7B636C6F", // V1 MSFS2020
                         "DC1887B394EECA940D4EBE46", // V2 MSFS2020+2024 v2.3.1
                         "AD19DE857405A5640BE1848D"  // V3 v2.3.5
            ],
            "MAX_WEIGHT_KG": 600,
            "VNE_TAS_KPH": 292
        },
        "JS3-15": {
            "KEY": "JS3-15",
            "TITLE": "JS3-15 (Madolo)",
            "TITLE_STRS": [ "js3-15", "js 3 15m" ],
            "NB21_ACFG": [ "14E993B8CAA8350EF404F92C", // V1 MSFS2020
                        "A51D14335FA6C71DBF197FEB", // V2 MSFS2020
                        "963040A114AE421A90E34873" // V3 MSFS2020+2024 v2.3.1
            ],
            "NB21_FMCG": [ "350C66E7F8C644AC30537D6B", // V1 MSFS2020
                        "D58D5A058359CA594AB55499", // V2 MSFS2020+2024 v2.3.1
                        "561255EA339516D8E6236C9B" // V3 MSFS2020+2024 v2.3.5
            ],
            "MAX_WEIGHT_KG": 525,
            "VNE_TAS_KPH": 292
        },
        "LS4": {
            "KEY": "LS4",
            "TITLE": "LS4 (Madolo)",
            "TITLE_STRS": [ "ls4" ],
            "NB21_ACFG": [ "A48A4EF4E2A9D96C843B4361",
                        '067AD89CAA95B9D8F2104D3C',
                        '46C5998C473790CDB000AAEC'  // V3 = MSFS2024 1.4.0
            ],
            "NB21_FMCG": [ "2CF10E6AEDEF85C111F41401",
                        '49297C175A997216905BE06D',
                        '2B2CAD92FD80DE5E3696CD9A', // V3 = MSFS2024 1.3.8
                        '9148FF5AA844B0AC1C8732BD',  // V4 = MSFS2024 1.4.0
                        '997D55A78464103E481B8092' // V5 MSFS2024 1.4.2
            ],
            "MAX_WEIGHT_KG": 525,
            "VNE_TAS_KPH": 282
        },
        "DG808S": {
            "KEY": "DG808S",
            "TITLE": "DG808S (Touching Cloud)",
            "TITLE_STRS": [ "dg808" ],
            "NB21_ACFG": [ "0D933FB14EC7C1FC5E9C50FF",
                        '617D8901FFC57865966C1A42',
                        'AD2A2DAE9489BE555A943A0B',
                        '7E3FC6A03E66257D41360809',
                        '35D6021031870C25807D6747', // V5 B21 mod 1.0.5
                        '11B195953C52FF4DAC12A2C6' // V6 B21 mod 1.1.1
            ],
            "NB21_FMCG": [ "612014C72D2B9816C06CB778",
                        '8BDD0288671E70B14A3F9944',
                        'D44F8E99540D500341A45DE0',
                        'A7342E88BA89EC47AA0EAB70', // V4 B21 mod 1.0.5
                        'C3BB67BF51C29EAA6D5D5998' // V5 B21 mod 1.1.1
            ],
            "MAX_WEIGHT_KG": 600,
            "VNE_TAS_KPH": 282
        },
        "AS7": {
            "KEY": "AS7",
            "TITLE": "ASK7 (GlideSimmer67)",
            "TITLE_STRS": [ "as7", "^k7$", " k7", "k7 ", "schleicherk7" ],
            "NB21_ACFG": [ "0CF71B19CD5135728AE56972",
                        "1179917BE9A2FBC690C157C5"
            ],
            "NB21_FMCG": [ "51EF38E151AAAFAA8D56AB13", // V1 MSFS2020
                        "ECCE3FB85D18431EE75840DC" // V2 MSFS2020 + 2024
            ],
            "MAX_WEIGHT_KG": 484.5,
            "VNE_TAS_KPH": 209
        },
        "AS8": {
            "KEY": "AS8",
            "TITLE": "Ka8 (LoneWolf)",
            "TITLE_STRS": [ "ka8", "ka 8", "k8 ", " k8"],
            "NB21_ACFG": [ "71ED97014EBA86352C8F8A8F" // V1
            ],
            "NB21_FMCG": [ "7354EA6583557FAD13D64680" // V1
            ],
            "MAX_WEIGHT_KG": 310,
            "VNE_TAS_KPH": 209
        },
        "D2C": {
            "KEY": "D2C",
            "TITLE": "Discus2c-18 (GotFriends)",
            "TITLE_STRS": [ "d2c", "discus" ],
            "NB21_ACFG": [ "3E0C44899BFAE022333DD031", // V1
                        '556D9BE3CCE77CC7A0A84A9D'     // V2
            ],
            "NB21_FMCG": [ "9423DEDB0380C1A9D482080A", // V1
                        'F5F9FFE0AC73623470D0D39A', // V2
                        'F310F9D3DEEA4B5B90CBD29B', // V3: 2.0.8
                        'F09A18F3A4B0A1DD95A8308E', // V4: 2.1.0
                        '0D3E5A401F352EE566C53109', // V5: engine?
                        '3AC21F9E1693E2F26F956EFA'  // V6: 2020/24 release 1
            ],
            "MAX_WEIGHT_KG": 565,
            "VNE_TAS_KPH": 292
        },
        "Asobo_LS8-18": {
            "KEY": "Asobo_LS8",
            "TITLE": "LS8 (Asobo)",
            "TITLE_STRS": [ "ls8", "mxs" ],
            "NB21_ACFG": [ "3B42B4378BE570DF675D2363F",
                        '913A154DD71DB358BC981B3A'
            ],
            "NB21_FMCG": [ "1101DA2C71E9B25D1363D936",
                        'E9CC0A261EFB7FB1449287ED'
            ],
            "MAX_WEIGHT_KG": 575,
            "VNE_TAS_KPH": 292
        },
        "DGF": {
            "KEY": "DGF",
            "TITLE": "DG1001 (Asobo)",
            "TITLE_STRS": [ "dgf", "dg1001" ],
            "NB21_ACFG": [ "CA728979D50E2D4E1B413891"
            ],
            "NB21_FMCG": [ "AEDA50561766217B28C244B7"
            ],
            "MAX_WEIGHT_KG": 750,
            "VNE_TAS_KPH": 282
        },
        "T31": {
            "KEY": "T31",
            "TITLE": "T31 (klem)",
            "TITLE_STRS": [ "t31" ],
            "MAX_WEIGHT_KG": 376,
            "VNE_TAS_KPH": 292
        },
        "SZD30": {
            "KEY": "SZD30",
            "TITLE": "SZD30 Pirat (Ignacy)",
            "TITLE_STRS": [ "szd30", "szd-30", "pirat", "yanosik" ],
            "NB21_ACFG": [ '5A6A99C67F3A928DC2954647', // 1.0
                        'B586C65483CE078AD2254383', // B21 1.1.1
                        '88E5E28E6A8AE3C379708CB1' // B21 1.3.6
            ],
            "NB21_FMCG": [ '5FA5FE53894E11284FD6FEF2', // 1.0
                        'FB56C6A897F6088BA3446CC9', // EPPR 1.1
                        '5790E5C13D1B05BB62BFF626' // B21 1.3.6
            ],
            "MAX_WEIGHT_KG": 370,
            "VNE_TAS_KPH": 204
        },
        "S12G": {
            "KEY": "S12G",
            "TITLE": "Stemme 12G (GotFriends)",
            "TITLE_STRS": ["stemme", "s12g"],
            "MAX_WEIGHT_KG": 900,
            "VNE_TAS_KPH": 282
        },
        "ASK21": {
            "KEY": "ASK21",
            "TITLE": "ASK21 (f7 Simulations)",
            "TITLE_STRS": ["ask21", "ask-21", "k21"],
            "MAX_WEIGHT_KG": 600,
            "VNE_TAS_KPH": 292,
            "NB21_ACFG": [ '0D80744D55C63B52D3858C4B', // 1.0
                        'CFBF0C2E620475F9DA335EDB', // 1.0 aero
                        '4752A186F3309FCDA2C89F70', // 1.05
                        '1DD715876D3E401A6CF62849',  // 1.05 aero
                        'F3AAD1FD4395E298FD9AC5AE' // 1.3.0
            ],
            "NB21_FMCG": [ 'CD2F043264848184C4B6D089', // 1.0 base & aero
                        '83B3D349102683CAAF23034A', // 1.05 base & aero
                        '548E2BA6550F987325F6D92D', // 1.2.0
                        '13D7A87B12889FDFE376F49E' // 1.3.0
            ]
        },
        "Taurus": {
            "KEY": "Taurus",
            "TITLE": "Taurus",
            "TITLE_STRS": ["taurus", "pipistrel"],
            "MAX_WEIGHT_KG": 550,
            "VNE_TAS_KPH": 282
        }
    }; // end glider_data

class B21_GLIDERS {

    constructor() {
    }


    // Only used inside B21_GLIDERS
    static lookup_key(glider_type, key) {
        let id = glider_type;
        if (B21_GLIDERS_DATA[glider_type] == null) {
            // That glider id not found, so search using title strings
            id = B21_GLIDERS.find_glider_type(id);
        }
        if (id != "") {
            return B21_GLIDERS_DATA[id][key];
        }
        return -1;
    }

    static check_key(glider_type, event_key, chksum) {
        console.log("B21_GLIDERS.check_key()",glider_type, event_key, chksum);
        let chksums = B21_GLIDERS.lookup_key(glider_type, "NB21_"+event_key);
        if (chksums == null) {
            return null; // key not found
        }
        if (chksums == -1) { // plane unrecognized
            return -1;
        }
        for (let i=0;i<chksums.length;i++) {
            if (chksums[i] == chksum) {
                return i;
            }
        }
        return null;
    }

    // Here's our plane-mapping code because MSFS does it so badly
    static find_glider_type(title_str) {

        let title_str_lc = title_str.toLowerCase();

        for (const [glider_type, glider_entry] of Object.entries(B21_GLIDERS_DATA)) {

            for (let i=0; i<glider_entry.TITLE_STRS.length; i++) {
                let r = new RegExp(glider_entry.TITLE_STRS[i]);
                if (r.test(title_str_lc)) {
                    return glider_type;
                }
            }
        }

        return "";
    }

    static get_glider_data(glider_type) {
        console.log(`B21_GLIDERS.get_glider_type '${glider_type}'`);
        if (B21_GLIDERS_DATA[glider_type] != null) {
            console.log(`B21_GLIDERS.get_glider_type '${glider_type} immediate success'`);
            return B21_GLIDERS_DATA[glider_type];
        }
        let gtype = B21_GLIDERS.find_glider_type(glider_type);
        if (gtype == "") {
            console.log(`B21_GLIDERS.get_glider_type '${glider_type}' find_glider_type failed`);
            return null;
        }
        console.log(`B21_GLIDERS.get_glider_type '${gtype}' returning glider_data `);
        return B21_GLIDERS_DATA[gtype];
    }
} // end class B21_GLIDERS


